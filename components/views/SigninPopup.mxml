<?xml version="1.0" encoding="utf-8"?>
<s:TitleWindow xmlns:fx="http://ns.adobe.com/mxml/2009"
			   xmlns:s="library://ns.adobe.com/flex/spark"
			   xmlns:mx="library://ns.adobe.com/flex/mx"
			   width="400" height="300" close="closeHandler(event)"
			   title="Welcome new user! Please sign in.">
	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
		<s:RadioButtonGroup id="genderSelection" selectedValue="MALE"/>
		
		<mx:HTTPService id="registerRequest"
						url="http://127.0.0.1:8000/register" method="GET"
						result="registerRequest_resultHandler(event)"
						fault="registerRequest_faultHandler(event)" />
	</fx:Declarations>
	
	<fx:Script>
		<![CDATA[
			import com.adobe.serialization.json.JSON;
			
			import mx.controls.Alert;
			import mx.events.CloseEvent;
			import mx.managers.PopUpManager;
			import mx.rpc.events.FaultEvent;
			import mx.rpc.events.ResultEvent;
			
			protected function registerRequest_resultHandler(event:ResultEvent):void
			{
				// TODO Auto-generated method stub
				Alert.show(event.result.toString());
			}
			
			protected function registerRequest_faultHandler(event:FaultEvent):void
			{
				// TODO Auto-generated method stub
				Alert.show(event.fault.faultString, event.fault.faultCode);
			}
			
			protected function signinConfirmBtn_clickHandler(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
				var o:Object = new Object();
				o.name = userName.text;
				o.phonenum = phoneNum.text;
				o.gender = (genderSelection.selectedValue == "MALE");
				
				var jsonstr:String = com.adobe.serialization.json.JSON.encode(o);
				//Alert.show(jsonstr);
				//registerRequest
				registerRequest.send(o);
			}
			
			protected function closeHandler(event:CloseEvent):void
			{
				// TODO Auto-generated method stub
				PopUpManager.removePopUp(this);
			}
			
		]]>
	</fx:Script>
	
	<s:VGroup width="100%" height="100%">
		<s:Form width="100%" height="85%">
			<s:FormItem label="User name: ">
				<s:TextInput id="userName"/>
			</s:FormItem>
			<s:FormItem label="Phone number: ">
				<s:TextInput id="phoneNum"/>
			</s:FormItem>
			<s:FormItem label="Gender: ">
				<s:RadioButton value="MALE" label="Male" groupName="genderSelection"/>
				<s:RadioButton value="FEMALE" label="Female" groupName="genderSelection"/>
			</s:FormItem>
			<s:FormItem label="Password: ">
				<s:TextInput id="password" displayAsPassword="true"/>
			</s:FormItem>
		</s:Form>
		<s:Group width="100%" height="15%">
			<s:Button id="signinConfirmBtn" label="Confirm"
					  click="signinConfirmBtn_clickHandler(event)" horizontalCenter="0"
					  verticalCenter="0"/>
		</s:Group>
	</s:VGroup>
</s:TitleWindow>
